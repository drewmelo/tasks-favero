---
title: "Exercício 9 (Capítulo 3) no R"
author: "André Melo"
format:
  ipynb: default
  html: default
filters:
  - ../_extensions/coatless-quarto/colab/colab.lua
magic-commands:
  r: "%%R"              # Custom R magic command
setup-cells:
  r:
    language: "python"    # Language assumed for the setup cell
    code: |
      # Custom R setup
      !pip install rpy2
      %load_ext rpy2.ipython
---

[![](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/drewmelo/tasks-favero/blob/master/capitulo3/cap3_exerc9.ipynb)


O arquivo 'Supermercados_Brasileiros.csv' apresenta dados de faturamento e número de lojas dos 20 maiores supermercadistas brasileiros em determinado ano (fonte: ABRAS - Associação Brasileira de Supermercados). Pede-se:

```{r}
#| label: libs
#| echo: true       # mostra o código
#| include: true    # garante que vira célula no .ipynb
#| message: false   # (opcional) esconde mensagens de carregamento
# Importação dos pacotes necessários
library(tidyverse)
```


```{r}
url <- "https://raw.githubusercontent.com/caio-azevedo/estatistica_aplicada/refs/heads/main/Semana%201/Supermercados_Brasileiros.csv"
df <- read_csv(url, show_col_types = F)

# Visualização da base de dados 'Avaliação Alunos'
df
```

a- Elabore o diagrama de dispersão para as variáveis faturamento e número de lojas.
```{r}
# Diagrama de dispersão
ggplot(data = df, aes(x = lojas, y = faturamento)) +
    geom_point() +
  labs(x = "Número de lojas",
       y = "Faturamento") +
  theme_minimal(base_size = 16)
```

b- Calcule o coeficiente de correlação de Pearson entre as duas variáveis.
```{r}
cor(df$lojas, df$faturamento)
```

c- Exclua os quatro maiores grupos supermercadistas em faturamento, assim como o grupo AM/PM Comestíveis Ltda., e elabore novamente o diagrama de dispersão.

```{r}
# Identificar os 4 maiores faturamentos
top4 <- df |> 
    arrange(desc(faturamento)) |> 
    head(n = 4) |> 
    pull(empresa)

# Filtrar o DataFrame
df_filtro <- df |> 
    filter(!empresa %in% c(top4, "AM/PM Comestíveis Ltda")) # lista dos grupos a excluir

df_filtro
```


```{r}
# Diagrama de dispersão
ggplot(data = df_filtro, aes(x = lojas, y = faturamento)) +
    geom_point() +
  labs(title = "Gráfico de Dispersão",
       x = "Número de lojas",
       y = "Faturamento") +
  theme_minimal(base_size = 16)
```

d- Calcule novamente o coeficiente de correlação de Pearson entre as duas variáveis estudadas.
```{r}
cor(df_filtro$lojas, df_filtro$faturamento)
```